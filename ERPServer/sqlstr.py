getDate = "REPLACE(REPLACE(REPLACE(REPLACE(CONVERT(varchar(100), GETDATE(), 25), '-', ''), ' ', ''), ':', ''), '.', '')"

kk = 'SELECT CONVERT(VARCHAR(12), dbo.f_getTime(1))'

sqlStrLa = "INSERT INTO COMFORT.dbo.LRPLA (LA001, LA002, LA003, LA004, LA005, LA012, LA013, LA014, " \
           "COMPANY, CREATE_DATE, CREATOR, USR_GROUP, FLAG) " \
           "VALUES('{planId}', '3', '', '01', '2', '{planVersion}', '1', SUBSTRING(dbo.f_getTime(1), 1, 8), " \
           "'COMFORT', dbo.f_getTime(1), 'Robot', '', 1) "

sqlStrLb = "INSERT INTO COMFORT.dbo.LRPLB (LB001, LB002, LB003, LB004, LB005, LB006, LB007, LB008, LB009, LB010, " \
           "LB017, COMPANY, CREATE_DATE, CREATOR, USR_GROUP, FLAG) " \
           "VALUES('{planId}', '', '', '', SUBSTRING(dbo.f_getTime(1), 1, 8), " \
           "SUBSTRING(dbo.f_getTime(1), 9, 2) + ':' + SUBSTRING(dbo.f_getTime(1), 11, 2), 'Robot', '', '2', " \
           "'3', '{planVersion}', 'COMFORT', dbo.f_getTime(1), 'Robot', '', 1)"

sqlStrTc = "INSERT INTO COMFORT.dbo.LRPTC (TC001, TC002, TC003,  TC004, TC005, TC006, TC007, TC008, TC009, TC010, " \
           "TC011, TC012, TC013, TC014, TC015, TC016, TC017, TC018, TC019, TC020, TC021, TC022, TC023, TC024, " \
           "TC025, TC026, TC027, TC028, TC029, TC030, TC031, TC033, TC034, TC035, TC042, TC043, TC044, TC045, TCC01, " \
           "TC046, TC047, TC048, COMPANY, CREATOR, CREATE_DATE) " \
           " " \
           "SELECT TC001, TC002, TC003, MB032 AS TC004, MB017 AS TC005, TC006, LEFT(dbo.f_getTime(1), 8) AS TC007, " \
           "'N' AS TC008, MA021 AS TC009, 0 AS TC010, MB148 AS TC011, TC006 AS TC012, 0 AS TC013, 0 AS TC014, " \
           "0 AS TC015, 0 AS TC016, 0 AS TC017, 0 AS TC018, 0 AS TC019, 0 AS TC020, 0 AS TC021, 0 AS TC022, " \
           "'' AS TC023, '2' AS TC024, " \
           "RIGHT('0000' + CONVERT(VARCHAR(4), ROW_NUMBER() Over (ORDER BY TC001, TC002, TC003)), 4) AS TC025, " \
           "TA047 AS TC026, TA048 AS TC027, TA049 AS TC028, 0 AS TC029, '' AS TC030, '' AS TC031, MB149 AS TC033, " \
           "TC006 AS TC034, TC006 AS TC034, '3' AS TC042, 0 AS TC043, 0 AS TC044, 0 AS TC045, '' AS TCC01, TC046, " \
           "'N' AS TC047, TC006 AS TC048, 'COMFORT', 'Robot', dbo.f_getTime(1) " \
           "FROM ( " \
           "	SELECT TA001 AS TC001, TA050 AS TC046, RTRIM(TB005) AS TC002, CAST(SUM(TB007) AS FLOAT) AS TC006,  " \
           "	CONVERT(VARCHAR(8), DATEADD(DAY, -1, CONVERT(DATE, TA007 ,112)), 112) AS TC003 " \
           "	FROM ( " \
           "		SELECT TA001, INVMB.MB026 MB026,TB005,TA007,TB007,TA023,TA024,TA025,TB013,TB014,TB011," \
           "            ISNULL(TB020,0) TB020,INVMB.MB004 MB004, INVMB.MB017 MB017, INVMB.MB025 MB025, " \
           "            INVMB.MB032 MB032, INVMB.MB036 MB036,  INVMB.MB037 MB037, INVMB.MB038 MB038, " \
           "            INVMB.MB039 MB039, INVMB.MB040 MB040, INVMB.MB068 MB068, INVMB.MB076 MB076, " \
           "    		INVMB.MB148 MB148, INVMB.MB149 MB149, TB024, TB025, INVMB.MB022 MB022, INVMB.MB443 MB443, " \
           "            TA037, TB009, TBC01,TA046,TA047,TA048,TA049,TA050,TA051 ,B.MB036 MB036B, " \
           "    		B.MB037 MB037B,B.MB038 MB038B,TB030,TA003,TA053,TA054,INVMB.MB455 MB455,TA056,TA057, " \
           "            TA058,TA059,TB028  ,TB017 " \
           "		FROM COMFORT.dbo.LRPTA LRPTA " \
           "		INNER JOIN COMFORT.dbo.INVMB B ON B.MB001=TA002 " \
           "		INNER JOIN COMFORT.dbo.LRPTB LRPTB ON TA001=TB001 AND TA050=TB029 AND TA028=TB013 " \
           "		INNER JOIN COMFORT.dbo.INVMB INVMB ON TB005=INVMB.MB001 " \
           "		WHERE TA051='N' AND TA001='{planId}' AND TA050='{planVersion}' AND INVMB.MB025='P' AND TA009='Y' " \
           "        AND TB007>0  AND (TB009='1' OR TB009='2')  AND INVMB.MB034='L'" \
           "	) AS A GROUP BY TA001, TA050, TB005, TA007 " \
           ") AS B " \
           "INNER JOIN COMFORT.dbo.LRPTA ON TA001 = TC001 " \
           "INNER JOIN COMFORT.dbo.INVMB ON MB001 = TC002 " \
           "INNER JOIN COMFORT.dbo.PURMA ON MA001 = MB032 " \
           "WHERE 1=1 " \
           "ORDER BY TC001, TC002, TC003"

